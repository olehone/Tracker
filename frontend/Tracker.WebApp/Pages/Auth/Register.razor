@page "/register"

<MudContainer MaxWidth="MaxWidth.Small"
              Class="d-flex align-center justify-center"
              Style="min-height: 100vh;">
    <MudPaper Elevation="4"
              Class="pa-8"
              Style="width: 100%; max-width: 400px;">

        <MudForm @ref=@form
                 @bind-IsValid=@isSuccess
                 Model=@registerModel>
            <MudStack Spacing="3">
                <MudTextField T="string"
                              @bind-Value=@registerModel.FirstName
                              Label="First Name"
                              For=@(() => registerModel.FirstName)
                              Required
                              Immediate
                              RequiredError="First name is required"/>

                <MudTextField T="string"
                              @bind-Value=@registerModel.LastName
                              Label="Last Name"/>

                <MudTextField T="string"
                              @bind-Value=@registerModel.Email
                              Label="Email"
                              For=@(() => registerModel.Email)
                              Required
                              Immediate
                              RequiredError="Email is required"/>

                <MudTextField T="string"
                              @bind-Value=@registerModel.Username
                              Label="Username"
                              For=@(() => registerModel.Username)
                              Required
                              Immediate
                              RequiredError="Username is required"/>

                <MudTextField T="string"
                              @bind-Value=@registerModel.Password
                              Label="Password"
                              For=@(() => registerModel.Password)
                              InputType=@InputType.Password
                              Required
                              Immediate
                              RequiredError="Password is required"/>

                <MudTextField T="string"
                              @bind-Value=@secondPassword
                              Label="Repeat Password"
                              For=@(() => secondPassword)
                              InputType=@InputType.Password
                              Required
                              Immediate
                              RequiredError="Repeat password is required"/>

                @if (!(errorMessages is null or []))
                {
                    @foreach (var error in errorMessages)
                    {
                        <MudAlert Severity="Severity.Error"
                                  Dense>
                            @error
                        </MudAlert>
                    }
                }

                <MudButton OnClick=@HandleRegister
                           Disabled=@(isLoading || !isSuccess)
                           FullWidth
                           Variant=Variant.Filled
                           Color=Color.Primary>
                    @if (isLoading)
                    {
                        <MudProgressCircular Size="Size.Small"
                                             Class="mx-3"/>
                        <MudText>Signing up...</MudText>
                    }
                    else
                    {
                        <MudText>Sign up</MudText>
                    }
                </MudButton>
            </MudStack>
        </MudForm>
    </MudPaper>
</MudContainer>
