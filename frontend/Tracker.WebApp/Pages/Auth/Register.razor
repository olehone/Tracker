@page "/register"

@using Microsoft.AspNetCore.Components.Routing
@using Tracker.WebApp.Pages.Auth

<MudContainer MaxWidth="MaxWidth.Small"
			  Class="d-flex align-center justify-center"
			  Style="min-height: 100vh;">
	<MudPaper Elevation="4"
			  Class="pa-8"
			  Style="width: 100%; max-width: 400px;">

		<MudForm @ref=@form
				 @bind-IsValid=@isSuccess
				 Model=@registerModel>
			<MudStack Spacing="3">
				<MudTextField T="string"
							  @bind-Value=@registerModel.FirstName
							  Label="First Name"
							  For=@(() => registerModel.FirstName)
							  Required="true"
							  Immediate="true"
							  RequiredError="First name is required" />

				<MudTextField T="string"
							  @bind-Value=@registerModel.LastName
							  Label="Last Name" />

				<MudTextField T="string"
							  @bind-Value=@registerModel.Email
							  Label="Email"
							  For=@(() => registerModel.Email)
							  Required="true"
							  Immediate="true"
							  RequiredError="Email is required" />

				<MudTextField T="string"
							  @bind-Value=@registerModel.Username
							  Label="Username"
							  For=@(() => registerModel.Username)
							  Required="true"
							  Immediate="true"
							  RequiredError="Username is required" />

				<MudTextField T="string"
							  @bind-Value=@registerModel.Password
							  Label="Password"
							  For=@(() => registerModel.Password)
							  InputType=@InputType.Password
							  Required="true"
							  Immediate="true"
							  RequiredError="Password is required" />

				<MudTextField T="string"
							  @bind-Value=@secondPassword
							  Label="Repeat Password"
							  For=@(() => secondPassword)
							  InputType=@InputType.Password
							  Required="true"
							  Immediate="true"
							  RequiredError="Repeat password is required" />

				@if (!(errorMessages is null or []))
				{
					@foreach (var error in errorMessages)
					{
						<MudAlert Severity="Severity.Error" Dense="true">
							@error
						</MudAlert>
					}
				}

				<MudButton OnClick=@HandleRegister
						   Disabled=@(isLoading||!isSuccess)
						   FullWidth="true"
						   Variant=Variant.Filled
						   Color=Color.Primary>
					@if (isLoading)
					{
						<MudProgressCircular Size="Size.Small"
											 Class="mx-3" />
						<MudText>Signing up...</MudText>
					}
					else
					{
						<MudText>Sign up</MudText>
					}
				</MudButton>
			</MudStack>
		</MudForm>
	</MudPaper>
</MudContainer>
