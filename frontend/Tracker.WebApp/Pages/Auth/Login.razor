@page "/login"

<MudContainer MaxWidth="MaxWidth.Small"
              Class="d-flex align-center justify-center"
              Style="min-height: 100vh;">
    <MudPaper Elevation="4"
              Class="pa-8"
              Style="width: 100%; max-width: 400px;">

        <MudForm @ref=@form
                 @bind-IsValid=@isSuccess
                 Model=@loginModel>
            <MudStack Spacing="3">

                <MudTextField T="string"
                              @bind-Value=@loginModel.Email
                              Label="Email"
                              For=@(() => loginModel.Email)
                              Required
                              Immediate
                              RequiredError="Email is required"/>

                <MudTextField T="string"
                              @bind-Value=@loginModel.Password
                              Label="Password"
                              For=@(() => loginModel.Password)
                              InputType="InputType.Password"
                              Required
                              Immediate
                              RequiredError="Password is required"/>

                @if (!(errorMessages is null or []))
                {
                    @foreach (var error in errorMessages)
                    {
                        <MudAlert Severity="Severity.Error"
                                  Dense>
                            @error
                        </MudAlert>
                    }
                }

                <MudButton OnClick=@HandleLogin
                           Disabled=@(isLoading || !isSuccess)
                           FullWidth
                           Variant=Variant.Filled
                           Color=Color.Primary>
                    @if (isLoading)
                    {
                        <MudProgressCircular Size="Size.Small"
                                             Indeterminate/>
                        <MudText>Signing in...</MudText>
                    }
                    else
                    {
                        <MudText>Sign in</MudText>
                    }
                </MudButton>
            </MudStack>
        </MudForm>
    </MudPaper>
</MudContainer>
